Configuration file grammar
==========================

CONFIG_FILE     := CONFIG* RULE_PKT+

# Constants
ETH_PORT        := integer  # < RTE_MAX_ETHPORTS
VLAN_ID         := integer  # < 4096
NAT_CONFIG_FILE := str      # relative or absolute path to a NAT configuration file

# Software configuration
CONFIG          := CONFIG_VLAN

CONFIG_VLAN     := vlan VLAN_ID "on port" ETH_PORT

# Rule to process a packet
RULE_PKT        := RULE_IN [ '|' RULE_FILTER ]+ '|' RULE_OUT

RULE_IN         := "in" ETH_PORT
RULE_OUT        := out [ETH_PORT | "discard"]
RULE_FILTER     := RULE_FILTER_NAT

RULE_FILTER_NAT := "nat" NAT_CONFIG_FILE


Examples
========

# using one ports

in 0 | nat /etc/nat_rules.conf | out 0

# using two ports

in 0 | nat /etc/nat_rules.conf | out 1
in 1 | nat /etc/nat_rules.conf | out 1


Evolution?
==========

It would be awesome to handle configurations, such as:

in 0 | vlan decap 5 | if ip.src matches 212.83.0.0/16 then discard else nat /etc/nat_rules.conf | out 0
